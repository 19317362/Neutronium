"use strict";!function(){function r(r){return!!(r&&r.constructor&&r.call&&r.apply)}var t=function(t,n){function e(r,n){Object.defineProperty(t,r,{value:n})}function u(r,t){var n=r.indexOf(t);n!=-1&&r.splice(n,1)}function i(r){return g.push(r),function(){return u(g,r)}}function o(){g.forEach(function(r){return r(b)}),b=[],E=!1}function c(r){if(Array.isArray(r)){if(0==r.length)return;b=b.concat(r)}else b.push(r);E!==!0&&(E=!0,setTimeout(o))}function a(r){if(g.length){var t=r();c(t)}}function f(r,t,n,e){this.index=r,this.value=t,this.status=n,void 0!==e&&(this.moved=e)}function p(r,t,n){return new f(r,t,"deleted",n)}function s(r,t,n){return new f(r,t,"added",n)}function l(r,t,n,e){e.push(p(r,n,t)),e.push(s(t,n,r))}function h(r,t,n){var e=[],u=n;return r.forEach(function(r){return e.push(p(u++,r))}),t.forEach(function(r){return e.push(s(n++,r))}),e}function y(r){var t=[];return r.forEach(function(r,n){return t.push(s(n,r))}),t}function v(r){for(var t=[],n=(r.length-1)/2,e=0;e<n;e++){var u=r.length-1-e,i=r[e],o=r[u];i!==o&&(l(e,u,o,t),l(u,e,i,t))}return t}function d(r,t){var n=String(r),e=String(t);return n.localeCompare(e)}function A(r){var t=[];return r.forEach(function(r,n){r.index!==n&&l(r.index,n,r.el,t)}),t}if(!t||!Array.isArray(t))throw new Error("subject should be an array");if(!n||!r(n))throw new Error("callBack should be a function");if(t.addCallBack)return t.addCallBack(n);e("addCallBack",i);var g=[],b=[],E=!1;return e("pop",function(){var r=this,t=Array.prototype.pop.apply(this,arguments);return a(function(){return p(r.length,t)}),t}),e("push",function(){var r=arguments[0],t=Array.prototype.push.apply(this,arguments);return a(function(){return s(t-1,r)}),t}),e("shift",function(){var r=Array.prototype.shift.apply(this,arguments);return a(function(){return p(0,r)}),r}),e("splice",function(r){var t=r<0?this.length+r:r;t>this.length-1&&(t=this.length-1);var n=Array.prototype.slice.call(arguments,2),e=Array.prototype.splice.apply(this,arguments);return a(function(){return h(e,n,t)}),e}),e("unshift",function(){var r=arguments,t=Array.prototype.unshift.apply(this,arguments);return a(function(){return y([].slice.call(r))}),t}),e("reverse",function(){var r=this,t=Array.prototype.reverse.apply(this,arguments);return a(function(){return v(r)}),t}),e("sort",function(r){var t=this.map(function(r,t){return{el:r,index:t}}),n=r?function(t,n){return r(t.el,n.el)}:function(r,t){return d(r.el,t.el)},e=Array.prototype.sort.call(t,n),u=e.map(function(r){return r.el});return u.unshift(0,this.length),Array.prototype.splice.apply(this,u),a(function(){return A(e)}),u.splice(2)}),i(n)};Object.defineProperty(Array.prototype,"subscribe",{value:function(r){return t(this,r)}})}();