"use strict"; !function () { function a(a) { return !!(a && a.constructor && a.call && a.apply) } var b = function (c, d) { function e(a, b) { Object.defineProperty(c, a, { value: b }) } function i(a, b) { var c = a.indexOf(b); c != -1 && a.splice(c, 1) } function j(a) { return f.push(a), function () { return i(f, a) } } function k() { f.forEach(function (a) { return a(g) }), g = [], h = !1 } function l(a) { if (Array.isArray(a)) { if (0 === a.length) return; g = g.concat(a) } else g.push(a); h !== !0 && (h = !0, setTimeout(k)) } function m(a) { if (f.length) { var b = a(); l(b) } } function n(a, b, c, d) { this.index = a, this.value = b, this.status = c, void 0 !== d && (this.moved = d) } function o(a, b, c) { return new n(a, b, "deleted", c) } function p(a, b, c) { return new n(a, b, "added", c) } function q(a, b, c, d) { d.push(o(a, c, b)), d.push(p(b, c, a)) } function u(a, b, c) { var d = [], e = c; return a.forEach(function (a) { return d.push(o(e++, a)) }), b.forEach(function (a) { return d.push(p(c++, a)) }), d } function w(a) { var b = []; return a.forEach(function (a, c) { return b.push(p(c, a)) }), b } function y(a) { for (var b = [], c = (a.length - 1) / 2, d = 0; d < c; d++) { var e = a.length - 1 - d, f = a[d], g = a[e]; f !== g && (q(d, e, g, b), q(e, d, f, b)) } return b } function A(a, b) { var c = String(a), d = String(b); return c.localeCompare(d) } function B(a) { var b = []; return a.forEach(function (a, c) { a.index !== c && q(a.index, c, a.el, b) }), b } if (!c || !Array.isArray(c)) throw new Error("subject should be an array"); if (!d || !a(d)) throw new Error("callBack should be a function"); if (c.addCallBack) return c.addCallBack(d); e("addCallBack", j); var f = [], g = [], h = !1, r = c.pop; e("pop", function () { var a = this, b = r.apply(this, arguments); return m(function () { return o(a.length, b) }), b }); var s = c.push; e("push", function () { var a = arguments[0], b = s.apply(this, arguments); return m(function () { return p(b - 1, a) }), b }); var t = c.shift; e("shift", function () { var a = t.apply(this, arguments); return m(function () { return o(0, a) }), a }); var v = c.splice; e("splice", function (a) { var b = a < 0 ? this.length + a : a; b > this.length && (b = this.length); var c = Array.prototype.slice.call(arguments, 2), d = v.apply(this, arguments); return m(function () { return u(d, c, b) }), d }); var x = c.unshift; e("unshift", function () { var a = arguments, b = x.apply(this, arguments); return m(function () { return w([].slice.call(a)) }), b }); var z = c.reverse; return e("reverse", function () { var a = this, b = z.apply(this, arguments); return m(function () { return y(a) }), b }), e("sort", function (a) { var b = this.map(function (a, b) { return { el: a, index: b } }), c = a ? function (b, c) { return a(b.el, c.el) } : function (a, b) { return A(a.el, b.el) }, d = Array.prototype.sort.call(b, c), e = d.map(function (a) { return a.el }); return e.unshift(0, this.length), v.apply(this, e), m(function () { return B(d) }), e.splice(2) }), j(d) }; Object.defineProperty(Array.prototype, "subscribe", { value: function (c) { return b(this, c) } }) }();