"use strict";(function(){function t(n,i,r,f){var c,a,e,v,o,s,h;if(n&&!u.has(n._MappedId)&&(c=f||typeof n,c==="object")){if(u.set(n._MappedId,n),Array.isArray(n)){for(r(n),a=n.length,e=0;e<a;e++)v=n[e],t(v,i,r);return}for(o in n)o!==l&&(s=n[o],h=typeof s,h!=="function")&&(i(n,o),t(s,i,r,h))}}function a(n,t){return function(i){for(var u=[],f=[],e=[],o=i.length,r=0;r<o;r++)u.push(i[r].value),f.push(i[r].status),e.push(i[r].index);t.TrackCollectionChanges(n,u,f,e)}}function v(n,t){var i=a(n,t),r=n.subscribe(i);n.silentSplice=function(){r();var t=n.splice.apply(n,arguments);return r=n.subscribe(i),t}}function y(n,t,i){var r=!1;return function(u,f){if(r){r=!1;return}if(u!==f){if(Array.isArray(u)){var e=[0,f.length].concat(u);f.splice.apply(f,e);r=!0;i[t]=f;return}n.TrackChanges(i,t,u)}}}function s(n){var t=n.status,i=n.command,r=n.inform,u=n.callBack;this.$watch("$data.__window__.State",function(n){var f=this,r;n.name==t&&(r=function(){return f.$data.__window__[i].Execute()},u(r))});this.$nextTick(function(){this.$data.__window__[r]=!0})}var n,f,h;console.log("VueGlue loaded");var c={silentChange:function(n,t){this[n].silence(t)}},l="_MappedId",u=new Map;n=null;f={init:function(n,t){return this.listener=n,this.change=t,this},listen:function(){return this.subscriber=this.listener(),this},silence:function(n){this.subscriber();this.change(n);this.listen()}};var e=function(i,r){return n?(t(i,function(t,i){t.__silenter||Object.defineProperty(t,"__silenter",{value:Object.create(c)});var u=t.__silenter,e=y(r,i,t),o=Object.create(f).init(function(){return n.$watch(function(){return t[i]},e)},function(n){return t[i]=n}).listen();u[i]=o},function(n){return v(n,r)}),i):i},o,p=new Promise(function(n){o=n}),w={methods:{enumImage:function(n,t){var i,r;return!n instanceof Enum?null:(i=t||this.enumImages,!i)?null:(r=i[n.type],r?r[n.name]:null)}}};var i=Vue.adapter,b=i.addOnReady({},function(){var n=this;s.call(this,{status:"Opened",command:"EndOpen",inform:"IsListeningOpen",callBack:function(t){return n.onOpen(t)}})}),k=i.addOnReady({},function(){var n=this;s.call(this,{status:"Closing",command:"CloseReady",inform:"IsListeningClose",callBack:function(t){return n.onClose(t)}})}),d={methods:{asPromise:function(n){return function(t){return new Promise(function(i,r){var u={fullfill:function(n){i(n)},reject:function(n){r(new Error(n))}};n.Execute(t,u)})}}}},r={props:{command:{type:Object,"default":null},arg:{type:Object,"default":null}},computed:{canExecute:function(){return this.command===null?!1:this.command.CanExecuteValue}},watch:{"command.CanExecuteCount":function(){this.computeCanExecute()},arg:function(){this.computeCanExecute()}},methods:{computeCanExecute:function(){this.command!==null&&this.command.CanExecute(this.arg)},execute:function(){if(this.canExecute){var n=this.beforeCommand;!n||n();this.command.Execute(this.arg)}}}};r=Vue.adapter.addOnReady(r,function(){var n=this;setTimeout(function(){!n.arg||n.computeCanExecute()})});h={enumMixin:w,openMixin:b,closeMixin:k,promiseMixin:d,commandMixin:r,inject:e,register:function(t,r){var u,f;return console.log("VueGlue register"),u=Vue._vmMixin,!u||Array.isArray(u)||(u=[u]),f=i.addOnReady({el:"#main",mixins:u,data:t},function(){o(null)}),n=new Vue(f),window.vm=n,e(t,r)},ready:p};window.glueHelper=h})();