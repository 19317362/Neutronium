"use strict";(function(){function i(n,r,u){var f,e;if(n&&!t.has(n._MappedId)&&typeof n=="object"){if(t.set(n._MappedId,n),Array.isArray(n)){u(n);n.forEach(function(n){return i(n,r,u)});return}for(f in n)n.hasOwnProperty(f)&&(e=n[f],typeof e!="function")&&(r(n,f),i(e,r,u))}}function l(n,t){return function(i){for(var u=[],f=[],e=[],o=i.length,r=0;r<o;r++)u.push(i[r].value),f.push(i[r].status),e.push(i[r].index);t.TrackCollectionChanges(n,u,f,e)}}function a(n,t){var i=l(n,t),r=n.subscribe(i);n.silentSplice=function(){r();var t=n.splice.apply(n,arguments);return r=n.subscribe(i),t}}function v(n,t,i){var r=!1;return function(u,f){if(r){r=!1;return}if(u!==f){if(Array.isArray(u)){var e=[0,f.length].concat(u);f.splice.apply(f,e);r=!0;i[t]=f;return}n.TrackChanges(i,t,u)}}}function h(n){var t=n.status,i=n.command,r=n.inform,u=n.callBack;this.$watch("$data.__window__.State",function(n){var f=this,r;n.name==t&&(r=function(){return f.$data.__window__[i].Execute()},u(r))});this.$nextTick(function(){this.$data.__window__[r]=!0})}var f,t,n,e,c;console.log("VueGlue loaded");f={silentChange:function(n,t){this[n].silence(t)}};t=new Map;n=null;e={init:function(n,t){return this.listener=n,this.change=t,this},listen:function(){return this.subscriber=this.listener(),this},silence:function(n){this.subscriber();this.change(n);this.listen()}};var o=function(t,r){return n?(i(t,function(t,i){t.__silenter||Object.defineProperty(t,"__silenter",{value:Object.create(f)});var u=t.__silenter,o=v(r,i,t),s=Object.create(e).init(function(){return n.$watch(function(){return t[i]},o)},function(n){return t[i]=n}).listen();u[i]=s},function(n){return a(n,r)}),t):t},s,y=new Promise(function(n){s=n}),p={methods:{enumImage:function(n,t){var i,r;return!n instanceof Enum?null:(i=t||this.enumImages,!i)?null:(r=i[n.type],r?r[n.name]:null)}}};var r=Vue.adapter,w=r.addOnReady({},function(){var n=this;h.call(this,{status:"Opened",command:"EndOpen",inform:"IsListeningOpen",callBack:function(t){return n.onOpen(t)}})}),b=r.addOnReady({},function(){var n=this;h.call(this,{status:"Closing",command:"CloseReady",inform:"IsListeningClose",callBack:function(t){return n.onClose(t)}})}),k={methods:{asPromise:function(n){return function(t){return new Promise(function(i,r){var u={fullfill:function(n){i(n)},reject:function(n){r(new Error(n))}};n.Execute(t,u)})}}}},u={props:{command:{type:Object,"default":null},arg:{type:Object,"default":null}},computed:{canExecute:function(){return this.command===null?!1:this.command.CanExecuteValue}},watch:{"command.CanExecuteCount":function(){this.computeCanExecute()},arg:function(){this.computeCanExecute()}},methods:{computeCanExecute:function(){this.command!==null&&this.command.CanExecute(this.arg)},execute:function(){if(this.canExecute){var n=this.beforeCommand;!n||n();this.command.Execute(this.arg)}}}};u=Vue.adapter.addOnReady(u,function(){var n=this;setTimeout(function(){!n.arg||n.computeCanExecute()})});c={enumMixin:p,openMixin:w,closeMixin:b,promiseMixin:k,commandMixin:u,inject:o,register:function(t,i){var u,f;return console.log("VueGlue register"),u=Vue._vmMixin,!u||Array.isArray(u)||(u=[u]),f=r.addOnReady({el:"#main",mixins:u,data:t},function(){s(null)}),n=new Vue(f),window.vm=n,o(t,i)},ready:y};window.glueHelper=c})();